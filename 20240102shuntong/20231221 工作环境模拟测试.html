<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/604023 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="60826"/>

<div>
<span><div>********************************************************************************************************</div><div><br/></div><div>            笔试时间自由，完全开放，如遇问题可随时上网检索</div><div>            提交时间没有强制限制，但是建议当日内无论是否完整完成都打包一份结果 和 开发时长 发到笔试群中</div><div><br/></div><div>********************************************************************************************************</div><div><br/></div><div>        预计时间：无背景5-8H，有背景4-6H</div><div><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">题目要求：</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">                    </span>要求1：<span style="font-weight: bold;">对于条件查询，</span><span style="font-weight: bold;">尽可能用dataframe的行列查询，活用下标(inde</span><span style="font-weight: bold;">x</span><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">)。条件</span><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">查询少</span><span style="font-size: unset; color: unset; font-family: unset; font-weight: bold;">用for循环实现，</span><span style="font-size: unset; color: unset; font-family: unset;">尽可能活用</span><span style="font-size: unset; color: unset; font-family: unset;">dataframe函数</span></div><div>                    要求2：提交的代码以.py后缀保存，要求可以用python命令直接运行。不要用.ipynb（jupyter）格式保存</div><div>                    要求3：自行估算实际花费时间，提交的文件中说明实际开发时间</div><div>                    要求4：开发代码须包含代码量5%的注释</div><div><br/></div><div>        1. 上半部分     </div><div>        《任务介绍》：匹配清洗整合外汇1分钟数据</div><div>        《输入数据》：Dukascorpy文件夹下的Askprice，Bidprice1分钟USDCNH外汇文件。</div><div>                                文件原始内容为bidprice的<span style="font-size: unset; color: unset; font-family: unset;">askprice的1分钟内开盘价-open（开始时间的价格），最高价-high，最低价-low，收盘价-close（结束时间的价格）。以下会以其大写字母OHLC或英文名称表示四个价格。</span></div><div>                    <img src="20231221 工作环境模拟测试_files/Image.png" type="image/png" data-filename="Image.png" width="451"/></div><div>        《处理方法》：</div><div>                    1.整合和转换原始数据：</div><div><br/></div><div>                            1.将三个ASK文件按时间顺序全部读入保留文件内记录的时间顺序，如果有重复时间记录那么就去重只保留任意一条。BID文件同理</div><div><span style="color: unset; font-family: unset; font-size: unset;">                            2.时间从UTC0 转 北京时间</span><br/></div><div>                            3.删除bid&lt;=0 或者 ask&lt;=0</div><div><br/></div><div>                            输出格式：datetimes(数字形式：yyyymmddHHMM00), bidClose/askClose </div><div><span style="font-size: unset; color: unset; font-family: unset;">                            </span>文件名：USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}_BID_raw.csv  </div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  </span>USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}_ASK_raw.csv   <span> </span><br/></div><div><br/></div><div>                    2.生成从开始时间到结束时间内的完整分钟时间序列数据，然后把BID和ASK按时间进行匹配，并输出文件：</div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    1</span>. 生成BID 和 ASK各自完整分钟序列 ： 当前分钟无数据就取前一个有效数据（提示函数：pandas merge_asof）</div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    2. </span>生成将BID和ASK数据的时间进行匹配，得到匹配后三列数据datetimes , bid (原名bidClose） <span style="font-size: unset; color: unset; font-family: unset;">, ask （原名askClose）</span><br/></div><div><span style="font-size: unset; color: unset; font-family: unset;"><br/></span></div><div>                            输出格式：datetimes(yyyymmddHHMM00), bid,<span style="font-size: unset; color: unset; font-family: unset;"> ask</span></div><div>                            文件名：USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}.csv  </div><div>                </div><div>                    3.统计一天内的每分钟（一天有1440分钟，统计范围从00:00到23:59）的平均价差和中值价差，并输出文件：</div><div>                            spread =  ask - bid      </div><div>                            平均价差 = mean(spread)</div><div>                            中值价差 = median(spread<span style="font-size: unset; color: unset; font-family: unset;">)</span></div><div><br/></div><div>                            输出格式：times （数字形式：HHMM），spread_mean，spread_median</div><div>                            文件名：USDCNH_spreadmeanmedian.csv</div><div>        </div><div>        《输出数据》：</div><div><span style="font-size: unset; color: unset; font-family: unset;">                1.csv文件：</span>USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}_BID_raw.csv  ,</div><div><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>    </span><span>  </span>USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}_ASK_raw.csv  , <span> </span><br/></div><div>                                  USDCNH_{开始日期yyyymmdd}_{结束日期yyyymmdd}.csv  ，<span style="font-size: unset; color: unset; font-family: unset;"> </span></div><div>                                  USDCNH_spreadmeanmedian.csv</div><div>                2.开发代码</div><div><br/></div><div>        2 下半部分</div><div><br/></div><div>        《任务介绍》：使用国内专业数据商 myquant-掘金量化 的api下载国内期货15分钟级数据，并按题目要求进行基本的数据预处理 和 生成主连合约。</div><div>        《输入数据》：基于数据商API-帮助手册下载数据并处理</div><div>        《处理方法》：</div><div>                        1.注册个人账户并安装myquant终端 和 pythonSDK（用于下载数据）</div><div>                           --网页：<a href="https://www.myquant.cn/">https://www.myquant.cn/</a>        </div><div><br/></div><div>                        2.下载中国CU（铜）合约的历史15分钟级数据 并 保存下载文件：</div><div>                                下载以下月份合约：CU SHFE 202307/202308/ ...  /202312/202401/202402/202403 ，下载近半年数据。下载代号例子：cu2307.SHFE</div><div>                                必要字段：datetime，contractmonth<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">(格式 YYYYMM，即”合约月份“，是标志该合约到期时间，不是当前日期的自然月 )</span> ， open，high，low，close，volume）</div><div>                                datetime 选用时间段的开始时间(bob)，adjust参数选择ADJUST_NONE，frequency选择900s</div><div>                                保存文件不限，可以按月份分别保存，或者一个文件内保存</div><div>                                下载独立合约，不要下载MYQUANT的连续主力合约</div><div><br/></div><div>                        3.数据预处理：</div><div>                                3.1 由于Myquant数据存在机器精度误差，需要基于合约价格最小变动位，调整OHLC四种价格：</div><div>                                        规则：调整后价格 = round(调整前价格 / tick) * tick</div><div>                                                  CU tick = 10 </div><div>                                </div><div>                                3.2 整合15分钟级数据为天级数据：</div><div>                                        规则：基于CU交易时间，每日 从 早上09:00:00开始 到 下一日半夜02:29:59结束 。基于15分钟数据统计每日内的dailyopen，dailyhigh，dailylow，dailyclose，dailyvolume</div><div>                                                 （dailyopen：当日开始点价格， dailyhigh：当日最高价格，  dailylow<span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">：当日最低价格，  </span>dailyclose<span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 微软雅黑; font-variant-caps: normal; font-variant-ligatures: normal;">：当日结束点价格， </span>dailyvolume：日总成交量）</div><div><span style="font-size: unset; color: unset; font-family: unset;">                                </span></div><div>                        4.基于每日成交量生成主连合约Sheet1和Sheet2，保存到一个excel文件内，命名CU_data.xlsx。</div><div>                                 规则：Sheet1：每日成交量最高的月份合约数据组合而成（格式：date，contractmonth，dailyopen，dailyhigh，dailylow，dailyclose，dailyvolume）</div><div>                                           Sheet2：基于Sheet1，在换月日的日期将该行数据替换为下个主力合约 的 当日数据 。</div><div><br/></div><div>                                                        换月日定义为Sheet1中满足[Contract_month][i] != Sheet1[Contract_month][i+1]的第i行日期</div><div><br/></div><div>                                 输出字段：date(格式 YYYYMMDD)，contractmonth(格式 YYYYMM），dailyopen，dailyhigh，dailylow，dailyclose，dailyvolume。</div><div>                        </div><div>        《提交输出》：</div><div>                    1.myquant的原始下载文件<span style="font-size: unset; color: unset; font-family: unset;">                    </span></div><div><span style="font-size: unset; color: unset; font-family: unset;">                    2.xlsx格式的CU主连文件，需要有Sheet1和Sheet2</span></div><div>                    3.开发代码</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>--------------------------------------<span style="font-size: unset; color: unset; font-family: unset;">-</span><span style="font-size: unset; color: unset; font-family: unset;">背景知识</span>附录<span style="font-size: unset; color: unset; font-family: unset;">-------------------------------------</span><span style="font-size: unset; color: unset; font-family: unset;">---------</span></div><div><br/></div><div><span style="font-size: unset; color: unset; font-family: unset;">！！！请先看完题目后再选择是否观看视频！！！以下内容与题目具体操作关联性不大，仅作用于辅助理解题目。</span></div><div><br/></div><div>                    测试题目将出现以下关键字：</div><div>                        1.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">交割</span>：在到期日后按合约进行的合约实物或现金交换及相关手续。</div><div>                        2.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">期货合约</span>：内容是用约定的价格，在未来约定的到期时间进行实物或者现金交割。</div><div>                        3.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">期货到期月</span>：期货合约的到期月（题目中简称”合约月份“），到期后将不能交易，而是准备进行交割。一个品种同一天内存在不同的到期月合约，比如  CU（中国上期所 - 铜期货）的四张不同到期月的合约  202101/202102/202103/202104  都可能在同一天能交易。</div><div>                        4.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">期货换月</span>：由于投机者手上不会有实物，所以都会在到期交割前平仓，或者换月。选择要换到的合约月份，一般是当前成交量最大的月份，这样流动性最好，价差更一般最小，交易成本相对低。</div><div>                        5.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">主力合约</span>：一般指当前成交量最高月份的合约</div><div>                        6.<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">主力</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">连续</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">合约（主连）</span>：一般指连续日期下每日最高成交的月份所组合成的合约数据</div><div><br/></div><div><br/></div><div>                b站视频 : <a href="https://www.bilibili.com/video/BV1B74114727?p=8&amp;vd_source=aa97465c5a0f44d3713ef12a1692a4c8">https://www.bilibili.com/video/BV1B74114727?p=8&amp;vd_source=aa97465c5a0f44d3713ef12a1692a4c8</a></div><div><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">    </span><span style="font-size: unset; color: unset; font-family: unset;">上期所官方铜期货合约定义：</span><a href="https://www.shfe.com.cn/products/ag/">https://www.shfe.com.cn/products/cu/</a>   （见品种手册）</div><div>                                    <img src="20231221 工作环境模拟测试_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>--------------------------------------<span style="font-size: unset; color: unset; font-family: unset;">-</span>调整记录<span style="font-size: unset; color: unset; font-family: unset;">-------------------------------------</span><span style="font-size: unset; color: unset; font-family: unset;">---------</span></div><div><br/></div><div>20220720 追加代码要求，修正任务说明</div><div>20221024 任务说明标准化</div><div>20220222 少部分描述调整</div><div>20220329 追加调整</div><div>20220407 合约下载月份调整</div><div><span style="font-size: unset; color: unset; font-family: unset;">20231103 上半部分调整为分钟数据下载和处理</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">20231108 强调合约月份+标注附加题目</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">20231220 换月日定义说明；下半改数据简单统计，无背景知识按指示处理；删除附加</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">20231221 下半改为FX处理; 上下调换</span></div><div><span style="font-size: unset; color: unset; font-family: unset;">20231226 FX处理修正</span></div><div><br/></div></span>
</div></body></html> 